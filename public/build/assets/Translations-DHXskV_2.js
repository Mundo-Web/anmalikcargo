var j=Object.defineProperty;var b=(e,r,a)=>r in e?j(e,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[r]=a;var g=(e,r,a)=>(b(e,typeof r!="symbol"?r+"":r,a),a);import{j as t}from"./FileViewer-CpM0iYLI.js";import{r as i}from"./index-B80Lgev0.js";import{c as T}from"./ReactAppend-CBRQCQGz.js";import{B as w}from"./Base-DWQFyVIp.js";import{C as E}from"./CreateReactScript-Bj11ghWz.js";import{T as N}from"./Table-fNNkvby0.js";import{M as C}from"./Modal-Dyq34CHD.js";import{R as S}from"./ReactAppend-C-tNgxIf.js";import"./sweetalert2.all-Dh0rZL5X.js";import{I as x}from"./InputFormGroup-DZ3W53Mr.js";import{m as h}from"./main-Br9xqDfn.js";import{B as k}from"./Results-B9dLaNz0.js";import{r as F}from"./DxBox-CdMuSyGE.js";import"./index-DO3Aws4m.js";import"./tippy-react.esm-CHhA99mn.js";/* empty css              */import"./Logout-Cj6nvmS-.js";import"./index.esm-CTa_PdWD.js";import"./axios-B4uVmeYG.js";import"./___vite-browser-external_commonjs-proxy-C9-083JZ.js";import"./useTranslation-DSJZvAiN.js";import"./Filter-DTu8ZgWI.js";/* empty css               */class B extends k{constructor(){super(...arguments);g(this,"path","admin/translations");g(this,"translate",async({group:a,key:l,value:c,lang_id:u})=>{try{const{status:s,result:o}=await h.Fetch(`/api/${this.path}/translate`,{method:"POST",body:JSON.stringify({group:a,key:l,value:c,lang_id:u})});if(!s)throw new Error((o==null?void 0:o.message)||"Error al guardar traducción");return h.Notify.add({icon:"/assets/img/icon.png",title:"Correcto",body:"Traducción guardada exitosamente",type:"success"}),o}catch(s){return h.Notify.add({icon:"/assets/img/icon.png",title:"Error",body:s.message,type:"danger"}),null}})}}const p=new B,_=({data:e,gridRef:r,isTranslationMode:a})=>{const[l,c]=i.useState(e.value||e.value_base),[u,s]=i.useState(!0),o=i.useRef(null),f=async()=>{try{const d={group:e.group,key:e.key,value:l,lang_id:e.lang_id};e.lang_id===e.default_lang_id?await p.save({...d,id:e.id}):await p.translate(d),r.current.dxDataGrid("instance").refresh(),s(!1)}catch{Notify.error("Error al guardar traducción")}};return t.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[t.jsx("input",{ref:o,className:"form-control flex-grow-1",value:l,onChange:d=>{c(d.target.value),s(!0)}}),u&&t.jsx("button",{className:"btn btn-xs btn-soft-primary",onClick:f,children:a?t.jsx("i",{className:"fa fa-language"}):t.jsx("i",{className:"fa fa-pen"})})]})},G=({current_lang_id:e,default_lang_id:r})=>{const a=i.useRef(),l=i.useRef(),c=i.useRef(),u=i.useRef(),s=i.useRef(),o=i.useRef(),[f,d]=i.useState(!1),R=n=>{d(!1),c.current.value="",u.current.value="",s.current.value="",o.current.value="",$(l.current).modal("show")},y=async n=>{n.preventDefault();const m={id:c.current.value||void 0,group:u.current.value,key:s.current.value,value:o.current.value};await p.save(m)&&($(a.current).dxDataGrid("instance").refresh(),$(l.current).modal("hide"))},v=e!==r;return t.jsxs(t.Fragment,{children:[t.jsx(N,{gridRef:a,title:"Traducciones",rest:p,toolBar:n=>{n.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(a.current).dxDataGrid("instance").refresh()}}),n.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo registro",hint:"Nuevo registro",onClick:()=>R()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"group",caption:"Grupo"},{dataField:"key",caption:"Clave",cellTemplate:(n,{data:m})=>{n.html(F(t.jsx(t.Fragment,{children:m.key})))}},{dataField:"value_base",caption:"Valor Español",width:"200px"},{dataField:"value",caption:v?"Traducción":"Valor",cellTemplate:(n,{data:m})=>{S(n,t.jsx(_,{data:m,gridRef:a,isTranslationMode:v}))}}]}),t.jsx(C,{modalRef:l,title:f?"Editar traducción":"Agregar traducción",onSubmit:y,size:"md",children:t.jsxs("div",{className:"row",id:"translations-container",children:[t.jsx("input",{ref:c,type:"hidden"}),t.jsx(x,{eRef:u,label:"Grupo",col:"col-12",required:!0}),t.jsx(x,{eRef:s,label:"Clave",col:"col-6",required:!0}),t.jsx(x,{eRef:o,label:"Valor",col:"col-6",required:!0})]})})]})};E((e,r)=>{T(e).render(t.jsx(w,{...r,title:"Traducciones",children:t.jsx(G,{...r})}))});
