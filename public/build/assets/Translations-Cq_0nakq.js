var T=Object.defineProperty;var w=(t,a,r)=>a in t?T(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r;var g=(t,a,r)=>(w(t,typeof a!="symbol"?a+"":a,r),r);import{j as e}from"./FileViewer-CpM0iYLI.js";import{r as n}from"./index-B80Lgev0.js";import{c as b}from"./ReactAppend-CBRQCQGz.js";import{B as F}from"./Base-DWQFyVIp.js";import{C as N}from"./CreateReactScript-Bj11ghWz.js";import{T as S}from"./Table-fNNkvby0.js";import{M as E}from"./Modal-Dyq34CHD.js";import{R as _}from"./ReactAppend-C-tNgxIf.js";import"./sweetalert2.all-Dh0rZL5X.js";import{I as x}from"./InputFormGroup-DZ3W53Mr.js";import{m as h}from"./main-Br9xqDfn.js";import{B as k}from"./Results-B9dLaNz0.js";import{r as v}from"./DxBox-CdMuSyGE.js";import"./index-DO3Aws4m.js";import"./tippy-react.esm-CHhA99mn.js";/* empty css              */import"./Logout-Cj6nvmS-.js";import"./index.esm-CTa_PdWD.js";import"./axios-B4uVmeYG.js";import"./___vite-browser-external_commonjs-proxy-C9-083JZ.js";import"./useTranslation-DSJZvAiN.js";import"./Filter-DTu8ZgWI.js";/* empty css               */class C extends k{constructor(){super(...arguments);g(this,"path","admin/translations");g(this,"translate",async({group:r,key:c,value:p,lang_id:u})=>{try{const{status:l,result:o}=await h.Fetch(`/api/${this.path}/translate`,{method:"POST",body:JSON.stringify({group:r,key:c,value:p,lang_id:u})});if(!l)throw new Error((o==null?void 0:o.message)||"Error al guardar traducción");return h.Notify.add({icon:"/assets/img/icon.png",title:"Correcto",body:"Traducción guardada exitosamente",type:"success"}),o}catch(l){return h.Notify.add({icon:"/assets/img/icon.png",title:"Error",body:l.message,type:"danger"}),null}})}}const m=new C,B=({data:t,gridRef:a,isTranslationMode:r})=>{const[c,p]=n.useState(t.value||t.value_base),[u,l]=n.useState(!1),o=n.useRef(null),f=t.value!==null&&t.value!==t.value_base,y=async()=>{try{const d={group:t.group,key:t.key,value:c,lang_id:t.lang_id};t.lang_id===t.default_lang_id?await m.save({...d,id:t.id}):await m.translate(d),a.current.dxDataGrid("instance").refresh(),l(!1)}catch{Notify.error("Error al guardar traducción")}};return e.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[!u&&e.jsx("span",{className:"text-nowrap",children:f?e.jsx("i",{className:"fas fa-check text-success"}):e.jsx("i",{className:"fas fa-times text-danger"})}),e.jsx("input",{ref:o,className:"form-control flex-grow-1",value:c,onChange:d=>{p(d.target.value),l(!0)},onFocus:()=>l(!0),onBlur:()=>setTimeout(()=>l(!1),200)}),u&&e.jsx("button",{className:"btn btn-xs btn-soft-primary",onClick:y,children:r?e.jsx("i",{className:"fa fa-language"}):e.jsx("i",{className:"fa fa-pen"})})]})},O=({current_lang_id:t,default_lang_id:a})=>{const r=n.useRef(),c=n.useRef(),p=n.useRef(),u=n.useRef(),l=n.useRef(),o=n.useRef(),[f,y]=n.useState(!1),d=async s=>{s.preventDefault();const i={id:p.current.value||void 0,group:u.current.value,key:l.current.value,value:o.current.value};await m.save(i)&&($(r.current).dxDataGrid("instance").refresh(),$(c.current).modal("hide"))},j=t!==a;return e.jsxs(e.Fragment,{children:[e.jsx(S,{gridRef:r,title:"Traducciones",rest:m,remoteOperations:{paging:!0,filtering:!0,sorting:!0},toolBar:s=>{},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"group",caption:"Grupo",allowFiltering:!1,filterOperations:["contains"],filterType:"text",cellTemplate:(s,{data:i})=>{s.html(v(e.jsx(e.Fragment,{children:i.group})))}},{dataField:"key",caption:"Clave",allowFiltering:!1,filterOperations:["contains"],filterType:"text",cellTemplate:(s,{data:i})=>{s.html(v(e.jsx(e.Fragment,{children:i.key})))}},{dataField:"value_base",caption:"Valor Español",width:"200px",allowFiltering:!0,filterOperations:["contains"],filterType:"text"},{dataField:"is_translated",caption:"Estado",width:"80px",allowFiltering:!1,filterType:"text",cellTemplate:(s,{data:i})=>{const R=i.value&&i.value!==i.value_base;s.html(v(e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"100%"},children:R?e.jsx("i",{className:"fas fa-check-circle text-success",title:"Traducido"}):e.jsx("i",{className:"fas fa-times-circle text-danger",title:"Sin traducir"})})))},calculateFilterExpression:(s,i)=>s==="traducido"?["is_translated","=",!0]:s==="no traducido"?["is_translated","=",!1]:null},{dataField:"value",caption:j?"Traducción":"Valor",allowFiltering:!1,cellTemplate:(s,{data:i})=>{_(s,e.jsx(B,{data:i,gridRef:r,isTranslationMode:j}))}}],options:{searchPanel:{visible:!0,width:240,placeholder:"Buscar...",highlightSearchText:!0},filterRow:{visible:!0,applyFilter:"auto"},paging:{pageSize:10},pager:{showPageSizeSelector:!0,allowedPageSizes:[10,25,50,100],showInfo:!0}}}),e.jsx(E,{modalRef:c,title:f?"Editar traducción":"Agregar traducción",onSubmit:d,size:"md",children:e.jsxs("div",{className:"row",id:"translations-container",children:[e.jsx("input",{ref:p,type:"hidden"}),e.jsx(x,{eRef:u,label:"Grupo",col:"col-12",required:!0}),e.jsx(x,{eRef:l,label:"Clave",col:"col-6",required:!0}),e.jsx(x,{eRef:o,label:"Valor",col:"col-6",required:!0})]})})]})};N((t,a)=>{b(t).render(e.jsx(F,{...a,title:"Traducciones",children:e.jsx(O,{...a})}))});
