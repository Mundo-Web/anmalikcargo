var v=Object.defineProperty;var R=(e,r,a)=>r in e?v(e,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[r]=a;var f=(e,r,a)=>(R(e,typeof r!="symbol"?r+"":r,a),a);import{j as t}from"./FileViewer-CpM0iYLI.js";import{r as s}from"./index-B80Lgev0.js";import{c as y}from"./ReactAppend-CBRQCQGz.js";import{B as b}from"./Base-DGm0zQT1.js";import{C as j}from"./CreateReactScript-Bj11ghWz.js";import{T as w}from"./Table-fNNkvby0.js";import{M as E}from"./Modal-Dyq34CHD.js";import{R as T}from"./ReactAppend-C-tNgxIf.js";import"./sweetalert2.all-Dh0rZL5X.js";import{I as g}from"./InputFormGroup-DZ3W53Mr.js";import{m as x}from"./main-Br9xqDfn.js";import{B as N}from"./Results-B9dLaNz0.js";import{r as C}from"./DxBox-CdMuSyGE.js";import"./index-DO3Aws4m.js";import"./tippy-react.esm-CHhA99mn.js";/* empty css              */import"./Logout-Cj6nvmS-.js";import"./index.esm-CTa_PdWD.js";import"./axios-B4uVmeYG.js";import"./___vite-browser-external_commonjs-proxy-C9-083JZ.js";import"./useTranslation-Ck1q50rN.js";import"./Base-DTu8ZgWI.js";/* empty css               */class S extends N{constructor(){super(...arguments);f(this,"path","admin/translations");f(this,"translate",async({group:a,key:l,value:c,lang_id:i})=>{try{const{status:u,result:n}=await x.Fetch(`/api/${this.path}/translate`,{method:"POST",body:JSON.stringify({group:a,key:l,value:c,lang_id:i})});if(!u)throw new Error((n==null?void 0:n.message)||"Error al guardar traducción");return x.Notify.add({icon:"/assets/img/icon.png",title:"Correcto",body:"Traducción guardada exitosamente",type:"success"}),n}catch(u){return x.Notify.add({icon:"/assets/img/icon.png",title:"Error",body:u.message,type:"danger"}),null}})}}const p=new S,k=({data:e,gridRef:r})=>{const[a,l]=s.useState(e.value||e.value_base),[c,i]=s.useState(!0),u=s.useRef(null),n=async()=>{try{const d={group:e.group,key:e.key,value:a,lang_id:e.lang_id};e.lang_id===e.default_lang_id?await p.save({...d,id:e.id}):await p.translate(d),r.current.dxDataGrid("instance").refresh(),i(!1)}catch{Notify.error("Error al guardar traducción")}};return t.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[t.jsx("input",{ref:u,className:"form-control flex-grow-1",value:a,onChange:d=>{l(d.target.value),i(!0)}}),c&&t.jsx("button",{className:"btn btn-xs btn-soft-primary",onClick:n,children:t.jsx("i",{className:"fa fa-language"})})]})},F=()=>{const e=s.useRef(),r=s.useRef(),a=s.useRef(),l=s.useRef(),c=s.useRef(),i=s.useRef(),[u,n]=s.useState(!1),d=o=>{n(!1),a.current.value="",l.current.value="",c.current.value="",i.current.value="",$(r.current).modal("show")},h=async o=>{o.preventDefault();const m={id:a.current.value||void 0,group:l.current.value,key:c.current.value,value:i.current.value};await p.save(m)&&($(e.current).dxDataGrid("instance").refresh(),$(r.current).modal("hide"))};return t.jsxs(t.Fragment,{children:[t.jsx(w,{gridRef:e,title:"Traducciones",rest:p,toolBar:o=>{o.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(e.current).dxDataGrid("instance").refresh()}}),o.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo registro",hint:"Nuevo registro",onClick:()=>d()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"group",caption:"Grupo"},{dataField:"key",caption:"Clave",cellTemplate:(o,{data:m})=>{o.html(C(t.jsx(t.Fragment,{children:m.key})))}},{dataField:"value_base",caption:"Valor Español",width:"200px"},{dataField:"value",caption:"Traducción",cellTemplate:(o,{data:m})=>{T(o,t.jsx(k,{data:m,gridRef:e}))}}]}),t.jsx(E,{modalRef:r,title:u?"Editar traducción":"Agregar traducción",onSubmit:h,size:"md",children:t.jsxs("div",{className:"row",id:"translations-container",children:[t.jsx("input",{ref:a,type:"hidden"}),t.jsx(g,{eRef:l,label:"Grupo",col:"col-12",required:!0}),t.jsx(g,{eRef:c,label:"Clave",col:"col-6",required:!0}),t.jsx(g,{eRef:i,label:"Valor",col:"col-6",required:!0})]})})]})};j((e,r)=>{y(e).render(t.jsx(b,{...r,title:"Traducciones",children:t.jsx(F,{...r})}))});
