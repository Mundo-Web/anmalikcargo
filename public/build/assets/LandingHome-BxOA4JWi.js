var I=Object.defineProperty;var G=(s,r,l)=>r in s?I(s,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):s[r]=l;var b=(s,r,l)=>(G(s,typeof r!="symbol"?r+"":r,l),l);import{j as t}from"./AboutHeader-CpM0iYLI.js";import{r as n}from"./index-B80Lgev0.js";import{c as _}from"./ReactAppend-CBRQCQGz.js";import{B as L}from"./Base-BFStvEN4.js";import{C as V}from"./CreateReactScript-CyT_ENnh.js";import{T as H}from"./Table-COKXynOQ.js";import{M}from"./Modal-DUfP1iw0.js";import{I as P}from"./InputFormGroup-CFHZRLOG.js";import{R as u}from"./ReactAppend-C-tNgxIf.js";import{D as F}from"./DxButton-CsjWvhyj.js";import{S as C}from"./SwitchFormGroup-Cv62QkRk.js";import{I as A}from"./ImageFormGroup-CUCbODBj.js";import{S}from"./sweetalert2.all-Dh0rZL5X.js";import{r as T}from"./DxBox-CdMuSyGE.js";import{T as y}from"./TextareaFormGroup-BkvHoRll.js";import{B as O}from"./Results-CRgPU-zH.js";import{V as W}from"./VideoFormGroup-b3ko2Ni3.js";import"./index-DO3Aws4m.js";import"./tippy-react.esm-CHhA99mn.js";/* empty css              */import"./Logout-Cj6nvmS-.js";import"./main-Br9xqDfn.js";import"./___vite-browser-external_commonjs-proxy-C9-083JZ.js";import"./index.esm-Cu-mVv1q.js";/* empty css               */class q extends O{constructor(){super(...arguments);b(this,"path","admin/landing_home");b(this,"hasFiles",!0)}}const p=new q,z=({items:s})=>{console.log(s);const r=n.useRef(),l=n.useRef(),f=n.useRef(),h=n.useRef(),x=n.useRef(),m=n.useRef(),a=n.useRef(),g=n.useRef(),[E,R]=n.useState(!1),d=n.useRef(),[j,v]=n.useState(!1),w=e=>{e!=null&&e.id?R(!0):R(!1),f.current.value=(e==null?void 0:e.id)??"",h.current.value=(e==null?void 0:e.title)??"",x.current.value=(e==null?void 0:e.description)??"",g.current.value=(e==null?void 0:e.link)??"",e!=null&&e.is_video?($(d.current).prop("checked",!1).trigger("click"),setTimeout(()=>{a.current&&(e!=null&&e.video)&&a.current.setVideoSrc(`/api/landing_home/video/${e.video}`)},100),v(!0)):($(d.current).prop("checked",!0).trigger("click"),m.image.src=`/api/landing_home/media/${e==null?void 0:e.image}`,m.current.value=null,v(!1)),$(l.current).modal("show")},N=async e=>{e.preventDefault();try{const i={id:f.current.value||void 0,title:h.current.value,description:x.current.value,link:g.current.value,is_video:d.current.checked?1:0},o=new FormData;for(const c in i)o.append(c,i[c]);if(j){if(a.current){const c=a.current.getFile();c&&o.append("video",c)}}else{const c=m.current.files[0];c&&o.append("image",c),o.append("video",null)}const k=await p.save(o);if(console.log(k),!k)return;console.log("Refrescando tabla..."),$(r.current).dxDataGrid("instance").refresh(),console.log("Cerrando modal..."),$(l.current).modal("hide")}catch(i){console.error("Error al enviar el formulario:",i),S.fire({icon:"error",title:"Error",text:"Hubo un error al enviar el formulario. Por favor, inténtalo de nuevo."})}},B=async({id:e,value:i})=>{await p.boolean({id:e,field:"visible",value:i})&&$(r.current).dxDataGrid("instance").refresh()},D=async e=>{const{isConfirmed:i}=await S.fire({title:"Eliminar sección",text:"¿Estás seguro de eliminar este sección?",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"});!i||!await p.delete(e)||$(r.current).dxDataGrid("instance").refresh()};return t.jsxs(t.Fragment,{children:[t.jsx(H,{gridRef:r,title:"Landing Home",rest:p,toolBar:e=>{e.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(r.current).dxDataGrid("instance").refresh()}}),e.unshift({widget:"dxButton",location:"after",options:{icon:"plus",text:"Nuevo sección",hint:"Nuevo sección",onClick:()=>w()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"image",caption:"Imagen",width:"100px",allowFiltering:!1,cellTemplate:(e,{data:i})=>{u(e,i.is_video?t.jsx("video",{src:`/api/landing_home/video/${i.video}`,autoPlay:!0,style:{width:"100px",height:"48px",objectFit:"cover",objectPosition:"center",borderRadius:"4px"},onError:o=>o.target.src="/api/cover/thumbnail/null"}):t.jsx("img",{src:`/api/landing_home/media/${i.image}`,style:{width:"100px",height:"48px",objectFit:"cover",objectPosition:"center",borderRadius:"4px"},onError:o=>o.target.src="/api/cover/thumbnail/null"}))}},{dataField:"title",caption:"Contenido",width:"50%",cellTemplate:(e,{data:i})=>{u(e,i.title?t.jsx("p",{className:"mb-0",style:{width:"100%"},children:t.jsx("b",{className:"d-block",children:i.title})}):t.jsx("i",{className:"text-muted",children:"- Sin contenido textual -"}))}},{dataField:"name",caption:"Contenido",width:"50%",cellTemplate:(e,{data:i})=>{u(e,i.description?t.jsx("p",{className:"mb-0",style:{width:"100%"},children:t.jsx("small",{className:"text-wrap text-muted",style:{overflow:"hidden",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2},children:i.description})}):t.jsx("i",{className:"text-muted",children:"- Sin contenido textual -"}))}},{dataField:"link",caption:"Link",cellTemplate:(e,{data:i})=>{i.link?e.html(T(t.jsx("a",{href:i.link,children:i.link}))):e.html(T(t.jsx("i",{className:"text-muted",children:"- Sin link -"})))}},{dataField:"visible",caption:"Visible",dataType:"boolean",width:"120px",cellTemplate:(e,{data:i})=>{u(e,t.jsx(C,{checked:i.visible,onChange:o=>B({id:i.id,value:o.target.checked})}))}},{caption:"Acciones",cellTemplate:(e,{data:i})=>{e.css("text-overflow","unset"),e.append(F({className:"btn btn-xs btn-soft-primary",title:"Editar",icon:"fa fa-pen",onClick:()=>w(i)})),e.append(F({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>D(i.id)}))},allowFiltering:!1,allowExporting:!1}]}),t.jsx(M,{modalRef:l,title:E?"Editar sección":"Agregar sección",onSubmit:N,size:"lg",children:t.jsxs("div",{className:"row",id:"principal-container",children:[t.jsx("input",{ref:f,type:"hidden"}),t.jsxs("div",{className:"col-md-6",children:[t.jsx(y,{eRef:h,label:"Título",rows:1}),t.jsx(y,{eRef:x,label:"Descripción",rows:3}),t.jsx(P,{eRef:g,label:"Link"}),t.jsx(C,{eRef:d,onChange:e=>v(e.target.checked),label:"Usar video en lugar de imagen",specification:"Solo se mostrará el video en la sección"})]}),t.jsx("div",{className:"col-md-6",children:j?t.jsx(W,{eRef:a,label:"Selecciona un video",col:"col-12"}):t.jsx(A,{eRef:m,label:"Imagen",col:"col-12",aspect:16/9,fit:"contain"})})]})})]})};V((s,r)=>{_(s).render(t.jsx(L,{...r,title:"Landing Inicio",children:t.jsx(z,{...r})}))});
